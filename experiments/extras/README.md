# Extras
This subdirectory contains data and scripts that are not directly used to get
the results for research questions.
But they are used within the project to get some statistical and analytical insights.

# Structure
| Visual              | Section   |
|---------------------|-----------|
| [Figure 1.](figure1)| III       |
| [Bootability Study](bootability_study) | IV.C |
| [Table VIII](table8)| VI.A      |

## Figure 1: Average patch coverage of syzkaller, kAFL, and defconfig. (Replication Study)
**Figure 1** illustrates the results of a replication study involving
configuration files used by the kernel fuzzers Syzkaller and kAFL, along with
their corresponding repaired configuration files.

To conduct this study, we utilized the **syz-kconf** utility to generate
Syzkaller configuration files for each commit ID.
We then applied the **koverage** tool from the kmax suite to identify any patch
commit lines excluded from the original Syzkaller configuration files.
If exclusions were detected, the **klocalizer** tool from kmax was used to
"repair" the configuration files, ensuring the inclusion of the missing lines.
The same procedure was performed for kAFL, using the configuration file provided
in the kAFL tutorial.

We quantified the increase in patch coverage achieved by the repaired
configuration files compared to the original Syzkaller and kAFL configurations
using the **calculate_confidence_intervals.py** script.
Additionally, we generated a bar chart to visualize the results of the
replication experiment, categorizing datasets into three groups:

1. Syzkaller vs. repaired Syzkaller configuration files,
2. kAFL vs. repaired kAFL configuration files, and
3. defconfig vs. repaired defconfig configuration files.

The patch coverage results for each dataset are saved in the following files
within the `figure1/` directory:

- `syzkaller_config_patchcoverage.txt`
- `krepair_patchcoverage.txt`
- `kafl_config_patchcoverage.txt`
- `kafl_krepair_patchcoverage.txt`
- `defconfig_config_patchcoverage.txt`
- `defconfig_krepair_patchcoverage.txt`

All replication study results are stored in: [#TODO: Add Zenodo link].


To get Figure 1, you can run the following command:
```Bash
docker exec -it artifacts-container sh -c "bash icse25/experiments/extras/figure1/get_figure_1.sh"; docker cp artifacts-container:/home/apprunner/icse25/experiments/extras/figure1/patchcoverage.pdf ./patchcoverage.pdf; open ./patchcoverage.pdf;
```
> [!NOTE]
> This script outputs information about mean, lower and upper bounds of the confidence
intervals of the patch coverage of syzkaller, kAFL, and defconfig configuration files.
It will also provide pdf file that contains the bar chart of the results with
the name `patchcoverage.pdf` under `figure1/` directory.

## Bootability Study
We evaluated the bootability of the kernel images built with the configuration
files generated by utilities like allyesconfig, allnoconfig, and randconfig.
We generated 100 configuration files with the randconfig utility, providing it
random seed of epoch time via the KCONFIG_SEED environment variable, and also
provided a probability of a configuration option to be enabled with 50% probability
via the KCONFIG_PROBABILITY environment variable.
We used Linux-next version v6.7 to compile the configuration files.
test_100_randconfigs.py script was used to generate configuration files with randconfig,
build kernel images with them, and try to boot the kernel images with QEMU.
We observed that 100% of the kernel images built with the configuration files
generated by the randconfig utility were not bootable.
Furthermore, we generated kernel images using configuration files generated by
allyesconfig and allnoconfig utilities on Linux-next version v6.7.
We observed that neither the kernel image built with the allyesconfig
configuration file nor the kernel image built with the allnoconfig configuration
file was bootable.

To replicate the bootability study, you can run the following command:
#TODO: This script requires linux-next folder and fails since we don't have it.
```Bash
docker exec -it artifacts-container bash -c "python3 -m venv myenv; source myenv/bin/activate; python3 -m pip install gitpython loguru tqdm; python3 icse25/experiments/extras/bootability_study/test_100_randconfigs.py; deactivate; rm -rf myenv;";
```
> [!NOTE]
> This script outputs a csv file named `bootability_study.csv` under `bootability_study/` directory.

# TABLE VIII: Bugs that depended on configuration variety to be found.
#TODO: Add data, scripts, and description of the table.
